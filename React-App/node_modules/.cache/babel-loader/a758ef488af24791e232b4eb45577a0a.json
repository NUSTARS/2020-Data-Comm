{"ast":null,"code":"import React, { useState, useEffect } from \"react\";\nimport { useTracked } from './globalState';\nconst updateInterval = 1000;\n\nasync function grabData() {\n  if (port) {\n    const response = await fetch('/request-data/', {});\n    const json = await response.json(); // if no new data, return 0\n\n    if (json.length == 0) {\n      return 0;\n    } // else return new data\n    else {\n        return json;\n      }\n  }\n}\n\nexport function GetData(props) {\n  const initialState = {\n    version: 0,\n    flags: 0\n  };\n  const [getDataState, setGetDataState] = useState(initialState);\n  const [state, setState] = useTracked();\n  useEffect(() => {\n    const interval = setInterval(async () => {\n      const d = await grabData();\n\n      if (!d) {\n        return;\n      } // d looks like: [{'version': 0, 'flags': 0, 'payloadSize': 0, 'seqNum': 0, 'checksum': 66047, 'time': '19:10:20', 'data': {0: 1, 1: 17}}, ...]\n      // data of form: {'label1': [[time1, value1], [time2, value2], ...], 'label2': [...], ...}\n\n\n      var mutdata = state.data;\n      d.forEach(el => Object.entries(el['data']).forEach(([key, val]) => {\n        key in mutdata ? mutdata[key].append([el['time'], val]) : mutdata[key] = [[el['time'], val]];\n      } // data[key][el[time]] = val\n      ));\n      setState({\n        data: mutata\n      });\n    }, updateInterval);\n    return () => clearInterval(interval);\n  }, []);\n}","map":{"version":3,"sources":["/Users/Nathan/Desktop/data-comm-ui/src/getData.js"],"names":["React","useState","useEffect","useTracked","updateInterval","grabData","port","response","fetch","json","length","GetData","props","initialState","version","flags","getDataState","setGetDataState","state","setState","interval","setInterval","d","mutdata","data","forEach","el","Object","entries","key","val","append","mutata","clearInterval"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,UAAT,QAA2B,eAA3B;AAEA,MAAMC,cAAc,GAAG,IAAvB;;AAEA,eAAeC,QAAf,GAA0B;AACxB,MAAIC,IAAJ,EAAU;AACR,UAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,gBAAD,EAAmB,EAAnB,CAA5B;AACA,UAAMC,IAAI,GAAG,MAAMF,QAAQ,CAACE,IAAT,EAAnB,CAFQ,CAIR;;AACA,QAAIA,IAAI,CAACC,MAAL,IAAe,CAAnB,EAAsB;AAAE,aAAO,CAAP;AAAW,KAAnC,CACA;AADA,SAEK;AAAE,eAAOD,IAAP;AAAc;AACtB;AACF;;AAGD,OAAO,SAASE,OAAT,CAAiBC,KAAjB,EAAwB;AAC7B,QAAMC,YAAY,GAAG;AACnBC,IAAAA,OAAO,EAAE,CADU;AAEnBC,IAAAA,KAAK,EAAE;AAFY,GAArB;AAKA,QAAM,CAACC,YAAD,EAAeC,eAAf,IAAkChB,QAAQ,CAACY,YAAD,CAAhD;AACA,QAAM,CAACK,KAAD,EAAQC,QAAR,IAAoBhB,UAAU,EAApC;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMkB,QAAQ,GAAGC,WAAW,CAAC,YAAY;AACvC,YAAMC,CAAC,GAAG,MAAMjB,QAAQ,EAAxB;;AACA,UAAK,CAACiB,CAAN,EAAU;AAAE;AAAS,OAFkB,CAIvC;AACA;;;AAEA,UAAIC,OAAO,GAAGL,KAAK,CAACM,IAApB;AACAF,MAAAA,CAAC,CAACG,OAAF,CAAUC,EAAE,IACVC,MAAM,CAACC,OAAP,CAAeF,EAAE,CAAC,MAAD,CAAjB,EAA2BD,OAA3B,CAAmC,CAAC,CAACI,GAAD,EAAMC,GAAN,CAAD,KACjC;AAAGD,QAAAA,GAAG,IAAIN,OAAR,GAAmBA,OAAO,CAACM,GAAD,CAAP,CAAaE,MAAb,CAAoB,CAACL,EAAE,CAAC,MAAD,CAAH,EAAaI,GAAb,CAApB,CAAnB,GAA4DP,OAAO,CAACM,GAAD,CAAP,GAAe,CAAC,CAACH,EAAE,CAAC,MAAD,CAAH,EAAaI,GAAb,CAAD,CAA3E;AAAiG,OADrG,CAEE;AAFF,OADF;AAOAX,MAAAA,QAAQ,CAAC;AAACK,QAAAA,IAAI,EAAEQ;AAAP,OAAD,CAAR;AACD,KAhB2B,EAgBzB5B,cAhByB,CAA5B;AAkBA,WAAO,MAAM6B,aAAa,CAACb,QAAD,CAA1B;AACD,GApBQ,EAoBN,EApBM,CAAT;AAsBD","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useTracked } from './globalState';\n\nconst updateInterval = 1000;\n\nasync function grabData() {\n  if (port) {\n    const response = await fetch('/request-data/', {});\n    const json = await response.json();\n\n    // if no new data, return 0\n    if (json.length == 0) { return 0; }\n    // else return new data\n    else { return json; }\n  }\n}\n \n\nexport function GetData(props) {\n  const initialState = {\n    version: 0,\n    flags: 0\n  };\n\n  const [getDataState, setGetDataState] = useState(initialState);\n  const [state, setState] = useTracked();\n\n  useEffect(() => {\n    const interval = setInterval(async () => {\n      const d = await grabData();\n      if ( !d ) { return; }\n\n      // d looks like: [{'version': 0, 'flags': 0, 'payloadSize': 0, 'seqNum': 0, 'checksum': 66047, 'time': '19:10:20', 'data': {0: 1, 1: 17}}, ...]\n      // data of form: {'label1': [[time1, value1], [time2, value2], ...], 'label2': [...], ...}\n\n      var mutdata = state.data;\n      d.forEach(el => \n        Object.entries(el['data']).forEach(([key, val]) => \n          { (key in mutdata) ? mutdata[key].append([el['time'], val]) : mutdata[key] = [[el['time'], val]]; }\n          // data[key][el[time]] = val\n          )\n        );\n\n      setState({data: mutata});\n    }, updateInterval);\n    \n    return () => clearInterval(interval);\n  }, []);\n\n}"]},"metadata":{},"sourceType":"module"}